@page "/toggl"
@inherits Fluxor.Blazor.Web.Components.FluxorComponent

<h3>Anzahl Toggl-Projekte</h3>

@if (TogglState.Value.Loaded)
{
    <p>@TogglProjectsNames.Count Toggl-Projekte geladen</p>
    <button type="button" class="btn btn-primary" @onclick="Synchronize">Synchronisieren</button>
    <label>Zuletzt synchronisiert: @TogglState.Value.LastSynchronized.ToString()</label>

    <ul>
    @foreach (var name in TogglProjectsNames.Keys)
    {
        @if (TogglProjectsNames[name])
        {
            <li>@name</li>
        }   
        else
        {
            <li style="color:red">@name (deleted)</li>
        }
    }
    </ul>
}
else
{
    <p>Keine Daten geladen - Toggl-Einstellungen fehlen</p>
    
    <EditForm Model="@TogglSettings" OnValidSubmit="@SaveTogglSettings">
        <label>Toggl API-Key: <InputText id="toggl-api-key" @bind-Value="TogglSettings.TogglApiKey" /></label>
        <label>Toggl Workspace-Id: <InputText id="toggl-workspace-id" @bind-Value="TogglSettings.TogglWorkspaceId" /></label>
        <button type="submit">Toggl-Daten speichern</button>
    </EditForm>


}
