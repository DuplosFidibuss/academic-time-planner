@page "/toggl"
@inherits Fluxor.Blazor.Web.Components.FluxorComponent

<h3>Anzahl Toggl-Projekte</h3>

@if (TogglState.Value.Loaded)
{
    <p>@LoadOverview.Count Toggl-Projekte geladen</p>
    <button type="button" class="btn btn-primary" @onclick="Synchronize">Synchronisieren</button>
    <label>Zuletzt synchronisiert: @TogglState.Value.LastSynchronized.ToString()</label>

    <p>Folgende Toggl-Projekte wurden geladen. Anzeigeformat: Toggl-Projekt -> assoziiertes Planprojekt</p>
    <ul>
    @foreach (var overviewData in LoadOverview)
    {
        @if (!overviewData.IsDeleted)
        {
            <li>@overviewData.TogglProjectName -> @overviewData.PlanProjectName</li>
        }   
        else
        {
            <li style="color:red">@overviewData.TogglProjectName (deleted) -> @overviewData.PlanProjectName</li>
        }
    }
    </ul>
}
else
{
    <p>Keine Daten geladen - Toggl-Einstellungen fehlen</p>
    
    <EditForm Model="@TogglSettings" OnValidSubmit="@SaveTogglSettings">
        <label>Toggl API-Key: <InputText id="toggl-api-key" @bind-Value="TogglSettings.TogglApiKey" /></label>
        <label>Toggl Workspace-Id: <InputText id="toggl-workspace-id" @bind-Value="TogglSettings.TogglWorkspaceId" /></label>
        <button type="submit">Toggl-Daten speichern</button>
    </EditForm>


}
