@page "/"
@inherits Fluxor.Blazor.Web.Components.FluxorComponent
@using AcademicTimePlanner.Store.State.ProjectFiles

<PageTitle>AcademicTimePlanner</PageTitle>

@if (ProjectState.Value.Step == ProjectFilesState.CreationStep.NotCreating)
{
    @if (ProjectState.Value.Loaded)
    {
        <p>@PlanProjectsNames.Count Plan-Projekte geladen</p>
    }

    <InputFile OnChange="@LoadPlanProjects" multiple />

    @if (ProjectState.Value.Loaded)
    {
        <ul>
            @foreach (var name in PlanProjectsNames)
            {
                <li>@name</li>
            }
        </ul>
    }
    <button type="button" class="btn btn-primary" @onclick="CreatePlanProject">Plan-Projekt erstellen</button>
}

@switch (ProjectState.Value.Step) 
{
    case ProjectFilesState.CreationStep.NamingProject :
        <EditForm Model="@planProject">
            <InputText id="projectName" @bind-Value="planProject!.Name"/>
        </EditForm>
        <button type="button" class="btn btn-primary" @onclick="Cancel">Abbrechen</button>
        <button type="button" class="btn btn-primary" @onclick="@(e => NextOrBack(ProjectFilesState.CreationStep.EnableTasks))">Weiter</button>
        break;
    case ProjectFilesState.CreationStep.EnableTasks :
        <EditForm Model="@planTask" OnInvalidSubmit="@CreatePlanTask">
            <InputText id="taskName" @bind-Value="planTask!.Name"/>
            <button type="submit">Task erstellen</button>
        </EditForm>
        <button type="button" class="btn btn-primary" @onclick="@(e => NextOrBack(ProjectFilesState.CreationStep.NamingProject))">Zurück</button>
        <button type="button" class="btn btn-primary" @onclick="Cancel">Abbrechen</button>
        <button type="button" class="btn btn-primary" @onclick="@(e => NextOrBack(ProjectFilesState.CreationStep.EnterEntries))">Weiter</button>
        break;
    case ProjectFilesState.CreationStep.EnterEntries :
        <button type="button" class="btn btn-primary" @onclick="@(e => NextOrBack(ProjectFilesState.CreationStep.EnableTasks))">Zurück</button>
        <button type="button" class="btn btn-primary" @onclick="Cancel">Abbrechen</button>
        <button type="button" class="btn btn-primary" @onclick="Finish">Projekt erstellen</button>
        break;
    default : break;
}